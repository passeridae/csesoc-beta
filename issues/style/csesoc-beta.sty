\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{csesoc-beta}[2014/11/28 0.01 CSESoc Beta magazine styles]

\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{color}
\usepackage{fancyhdr}
\usepackage{fontspec}
\usepackage[a4paper]{geometry}
\usepackage{graphicx}
\usepackage{hyperref}
\usepackage{hyphenat}
\usepackage{ifluatex}
\usepackage{ifxetex}
\usepackage{mathpazo}
\usepackage[protrusion=true,expansion]{microtype}
\usepackage[colaction]{multicol}
\usepackage{pdfpages}
\usepackage{titlesec}
\usepackage{tocloft}

\newcommand{\csesocbeta}{CSE{}Soc~{\sffamily βeta}}
%\newcommand{\csesocbeta}{CSE{}Soc~$\beta$eta}

\defaultfontfeatures{Ligatures=TeX}
\setmainfont[BoldFont={Klinic Slab Medium},
             ItalicFont={Klinic Slab Book Italic}]{Klinic Slab Book}
\setsansfont[Scale=MatchLowercase,
             BoldFont={Roboto Bold},ItalicFont={Roboto Italic}]{Roboto Regular}
\setmonofont[Scale=MatchLowercase]{Andale Mono}

%% hyperref
\hypersetup{unicode=true,
  bookmarks=true,
  bookmarksnumbered=false,
  bookmarksopen=false,
  breaklinks=false,
  pdfborder={0.7 0.2 0},
  backref=false,
  colorlinks=false,
  pdftitle={CSESoc Beta},
  pdfauthor={UNSW CSESoc; Jashank Jeremy <csesoc.beta.head@cse>}}

%% geometry
\geometry{tmargin=1.75cm,bmargin=1.75cm,
          lmargin=.75in,rmargin=.75in,
          headheight=14pt,headsep=1cm,footskip=1cm}

%% Fancy headers
\fancypagestyle{mag}{\fancyhf{}%
  \fancyfoot[RO]{{\small CSE{}Soc\texttt{.unsw.edu.au}}\hspace*{1ex}{\sffamily βeta}\hspace*{1ex}\the@year/\textit{issue}\the@issue\hspace*{1ex}\rule[2pt]{2pt}{2pt}\hspace*{1ex}\thepage}%
  \fancyfoot[LE]{\thepage\hspace*{1ex}\rule[1pt]{4pt}{4pt}\hspace*{1ex}{\small CSE{}Soc\texttt{.unsw.edu.au}}\hspace*{1ex}{\sffamily βeta}\hspace*{1ex}\the@year/\textit{issue}\the@issue}}
\renewcommand{\headrulewidth}{0pt}
\pagestyle{mag}

%% Chapter headings
\newcommand{\hsp}{\hspace{1em}}

\newcommand{\byline}[1]{%
  {\raggedleft\rule[1pt]{4pt}{4pt}%
    \hspace{0.5em}\it\sffamily #1\\ }}

% Section
\titleformat{\section}[block]%
            {\filcenter\sffamily\huge}%
            {\thesection\hsp}%
            {0pt}%
            {\huge}
\titlespacing*{\section}{0pt}{0pt}{.25ex}
\titleformat{\subsection}[block]%
            {\filright\sffamily\Large}%
            {\thesection\hsp}%
            {0pt}%
            {\Large}
\titlespacing{\paragraph}{0pt}{3pt}{3pt}

\setcounter{secnumdepth}{0}
\setcounter{tocdepth}{1}
\setlength{\parskip}{\smallskipamount}
\setlength{\parindent}{0pt}
%\raggedcolumns

% cwpuzzle patches
\usepackage[small]{cwpuzzle}
\renewcommand{\PuzzleClueFont}{\normalsize}
\renewcommand{\PuzzleCluePre}{\null}
\renewcommand{\PuzzleCluePost}{\null}
\renewcommand\Puzzle@Clue@@normal[3]{\textsf{\textbf{#1}}~#3 }
\renewcommand\PuzzleBlackBox{\textcolor{gray}{\rule{\PuzzleUnitlength}{\PuzzleUnitlength}}}

% sometimes this code tikz me off
\usepackage{tikz}
\usepackage[skins]{tcolorbox}

\definecolor{socialcolor}{rgb}{0.302,0.565,0.941} % #4d90f0
\newcommand{\bcalSocial}{\raisebox{-3pt}{\tikzpicture%
    \fill[color=socialcolor, rounded corners=3pt] (-1pt,-1pt) rectangle (3.5em,11pt);%
    \draw[white] (1.75em,5pt) node {\textsf{social}}; \endtikzpicture}}

\definecolor{newscolor}{rgb}{1.0,0.643,0.0} % #ffa400
\newcommand{\bcalNews}{\raisebox{-3pt}{\tikzpicture%
    \fill[color=newscolor, rounded corners=3pt] (-1pt,-1pt) rectangle (3em,11pt);%
    \draw[white] (1.5em,5pt) node {\textsf{news}}; \endtikzpicture}}

\definecolor{careerscolor}{rgb}{0.0,0.741,0.224} % #00bd39
\newcommand{\bcalCareers}{\raisebox{-3pt}{\tikzpicture%
    \fill[color=careerscolor, rounded corners=3pt] (-1pt,-1pt) rectangle (3.5em,11pt);%
    \draw[white] (1.75em,5pt) node {\textsf{careers}}; \endtikzpicture}}

\definecolor{techcolor}{rgb}{0.941,0.302,0.302} % #f04d4d
\newcommand{\bcalTech}{\raisebox{-3pt}{\tikzpicture%
    \fill[color=techcolor, rounded corners=3pt] (-1pt,-1pt) rectangle (3em,11pt);%
    \draw[white] (1.5em,5pt) node {\textsf{tech}}; \endtikzpicture}}

\newcommand{\calendarlink}[1]{For more details, head to\\%
\href{https://www.csesoc.unsw.edu.au/blog/#1/}{\texttt{csesoc.unsw.edu.au/blog/\\\hspace*{6ex}#1}}}

\renewcommand{\contentsname}{In This Issue}
\renewcommand{\cftsecleader}{\cftdotfill{\cftdotsep}}
\def\malcontents{%
  {\centering\LARGE\sffamily \contentsname}%
  \@starttoc{toc}}
\makeatletter
\renewcommand*\l@section{\@dottedtocline{1}{0pt}{1em}}

%\let\@thispagestyle\thispagestyle
%\renewcommand{\thispagestyle}[1]{\message{thispagestyle #1}\makeatletter\@thispagestyle{#1}}

\newcommand{\unsw}{\textsc{unsw}}\let\UNSW\unsw
\newcommand{\cse}{\textsc{cse}}\let\CSE\cse
\newcommand{\comp}{\textsc{comp}}\let\COMP\comp
\newcommand{\seng}{\textsc{seng}}\let\SENG\seng
\newcommand{\kk}{\textsc{k}}\let\KK\kk

\def\maketitle{%
\begingroup%
\vspace*{-3.5cm}\centering\hspace*{-2.8cm}%
\includegraphics[trim=0mm 20mm 0mm 0mm, clip, width=22cm]{../../style/beta-logo.pdf}%
\vspace{1em}
\endgroup}
